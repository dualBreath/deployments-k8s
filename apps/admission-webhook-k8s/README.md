# Autogenerated Webhook

## Prerequisite

This is only possible for local setup:
- clone project
- use [`to-local.sh`](../../to-local.sh)
- then run all the commands in the `deployments-k8s` folder

## Autogenerated webhook mode

If you want to use the automatically generated configuration and certificate for the admission webhook, you need to complete the following steps:

- remove Spire spiffeid template if it exists:
```bash
  $ kubectl delete clusterspiffeid.spire.spiffe.io/nsm-workloads-webhook
```
- remove `mutating-webhook-config.yaml` from `kustomization.yaml` resources
- add env variable to `admission-webhook.yaml`:
```bash
- name: NSM_WEBHOOK_MODE
  value: selfsigned
```
